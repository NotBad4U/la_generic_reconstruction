\documentclass[runningheads]{llncs}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{mathtools}
\usepackage[dvipsnames]{xcolor}
\usepackage{wasysym}
\usepackage{annotate-equations}
\usepackage{quiver}
\usepackage{cleveref}
\usepackage{ebproof}
\usepackage[T1]{fontenc}
\usepackage{wasysym}
\usepackage{multirow}

% comments with
% https://mirror.ox.ac.uk/sites/ctan.org/macros/latex/contrib/todonotes/todonotes.pdf
\usepackage[colorinlistoftodos]{todonotes}


%%%% configuration and new commands  %%%%
\input{commands}
\input{listing-config}

\renewcommand{\floatpagefraction}{.99}

\begin{document}

% \title{Verifying SMT-Based Linear Integer Arithmetic in Lambdapi}
% \title{SMT Linear Integer Arithmetic proof checking in Lambdapi}
\title{Checking Linear Integer Arithmetic Proofs\\ in Lambdapi}

% \titlerunning{Verification of LIA proof with Lambdapi}

\author{Alessio Coltellacci\inst{1}\orcidID{0009-0005-3580-2075}
  \and
  Stephan Merz\inst{1}\orcidID{0000-0003-0974-1844}
}
%
\authorrunning{A. Coltellacci, S. Merz}
% First names are abbreviated in the running head.
% If there are more than two authors, 'et al.' is used.
%
\institute{University of Lorraine, CNRS, Inria, LORIA, Nancy 
%\email{alessio.coltellacci@inria.fr}
}

% \institute{University of Lorraine, CNRS, Inria, LORIA \and
% Nancy
% \email{alessio.coltellacci@inria.fr}\\
% \url{http://www.springer.com/gp/computer-science/lncs} \and
% ABC Institute, Rupert-Karls-University Heidelberg, Heidelberg, Germany\\
% \email{\{abc,lncs\}@uni-heidelberg.de}}
%
\maketitle
%
\begin{abstract}
Modern SMT solvers can generate proofs of unsatisfiability to ensure correctness independently of their implementation.
A dependable approach to verify these proofs is to reconstruct them within a proof assistant.
In previous work, the SMT checker Carcara was extended to reconstruct SMT proofs in Lambdapi â€” a proof assistant designed for interoperability,
supporting the import and export of proofs for integration with other proof assistants such as Rocq, Lean, or HOL-Light.
Whereas that work was limited to SMT theories without arithmetic, we here present an extension that enables the reconstruction of SMT proofs involving linear integer arithmetic.

\keywords{SMT \and Alethe \and integer arithmetic \and Lambdapi \and normal form \and proof by reflection}
\end{abstract}

\section{Introduction}

SMT solvers have become capable of producing proofs of unsatisfiability,  enabling independent verification of correctness without relying on the solver's implementation.
This development addresses the growing need for trustworthy verification in safety-critical applications and SMT solver usage in proof assistant, where the solver cannot be assumed to be fully trusted.
Alethe \cite{alethe,alethespec} is an established SMT proof format supported by the solvers cvc5 and veriT. In our previous work \cite{ColtellacciMD24}, we extended the Alethe proof checker and elaborator Carcara \cite{carcara} to
reconstruct Alethe SMT proofs within the Lambdapi proof assistant, thereby ensuring their validity.
Lambdapi \cite{lambdapi} is a proof assistant based on the $\lambda\Pi$-calculus modulo rewriting \cite{lpmodulo}, a logical framework \cite{lf} that extends the $\lambda$-calculus with dependent types and user-defined rewrite rules.
This foundation allows Lambdapi to serve as a framework for formalizing various logical systems.
Designed with interoperability in mind, Lambdapi can import and export proofs, facilitating integration with other proof assistants \cite{LPAR2024:Translating_HOL_Light_proofs} such as Rocq \cite{Rocq-refman}, Lean \cite{lean4:2021}, and HOL-Light. 

However, our prior work was limited to proofs expressed within the logic of Uninterpreted Functions (UF) and Quantifier-Free (QF), as well as their subtheories. 
In the present work, we extend this approach to support the reconstruction of proof steps involving linear integer arithmetic (LIA).
When the propositional model is unsatisfiable in the theory of linear (integer) arithmetic, the solver creates a proof certificate.
The conclusion is a tautological clause of linear inequalities and equations and the justification of the step is a list of coefficients so that the linear combination becomes a trivially contradictory inequality after simplification (e.g., $0 \geq 1$).
Most SMT solvers, including cvc5 and veriT, use the simplex method \cite{SRI:simplex:dpllt} to handle linear arithmetic.\todo[sm]{Is that relevant for proof checking?}
To verify these certificates, we implemented an automatic decision procedure based on proof by reflection \cite{reflection-origin-coq,ring-coq}.

The remainder of this paper is organized as follows.
In \cref{sec:background}, we provide an overview of Lambdapi and present the structure of Alethe proof certificates for linear arithmetic.
Then, in \cref{sec:elaboration-lia}, we describe how we leverage Carcara's elaboration process to reconstruct linear integer arithmetic steps, even when coefficient annotations are missing.
In \cref{sec:encoding} introduces our encoding of SMT linear arithmetic within Lambdapi, while in \cref{sec:lia-reconstruction} presents an automatic decision procedure, based on proof by reflection, to verify these arithmetic steps.
An empirical evaluation of our approach is provided in \cref{sec:evaluation}. We review related work in \cref{sec:related}, and we conclude in \cref{sec:conclusion}.

\input{background}

\input{elaboration}

\input{lambdapi}

\input{lia-reconstruction}

\input{evaluation}

\section{Related work}
\label{sec:related}

The reconstruction for Alethe proofs produced by the veriT solver has been implemented within Isabelle/HOL to enhance the reconstruction success rate compared to Z3.
The authors employed Isabelle's \emph{linarith} procedure to replay arithmetic reasoning steps. This tactic serves as a decision procedure over real numbers, rather than integers or natural numbers, and is based on Fourier-Motzkin elimination.
However, the authors note that Isabelle's arithmetic procedure is incomplete and relatively inefficient for reconstructing arithmetic proofs; consequently, specific rules are reconstructed heuristically to improve performance.

Besson \cite{micromega} introduces a modular framework for integrating SMT solvers with the Rocq proof assistant, emphasizing the generation and efficient verification of proof certificates directly within Coq.
His approach enables fast, reflexive proof checking using Nelson-Oppen-style theory combination, and it supports both Linear Integer Arithmetic (LIA) and Linear Arithmetic (LA) logics.
To efficiently generate Farkas certificates for LA, the technique relies on the Simplex algorithm, while for LIA, a variant of the Omega test \cite{omegatest} is adopted.
The technique has been evaluated on SMT-LIB 2 benchmarks using the Z3 solver.
\todo[sm]{I think you need to discuss how performances of the techniques compare, as far as they are comparable.}



\section{Conclusion}
\label{sec:conclusion}

\bibliographystyle{splncs04}
\todo[sm]{Fix capitalization in references.}
\bibliography{refs}

\include{appendix}

\end{document}
